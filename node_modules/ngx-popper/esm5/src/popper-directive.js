/**
 * @fileoverview added by tsickle
 * @suppress {checkTypes,extraRequire,missingReturn,unusedPrivateMembers,uselessCode} checked by tsc
 */
import * as tslib_1 from "tslib";
import { Directive, ViewContainerRef, ComponentFactoryResolver, Input, Output, EventEmitter, Renderer2, ChangeDetectorRef, Inject, ElementRef } from '@angular/core';
import { Placements, Triggers } from './popper-model';
import { PopperContent } from './popper-content';
var PopperController = /** @class */ (function () {
    function PopperController(viewContainerRef, changeDetectorRef, resolver, elementRef, renderer, popperDefaults) {
        if (popperDefaults === void 0) { popperDefaults = {}; }
        this.viewContainerRef = viewContainerRef;
        this.changeDetectorRef = changeDetectorRef;
        this.resolver = resolver;
        this.elementRef = elementRef;
        this.renderer = renderer;
        this.popperDefaults = popperDefaults;
        this.popperContentClass = PopperContent;
        this.shown = false;
        this.subscriptions = [];
        this.eventListeners = [];
        this.globalEventListeners = [];
        this.hideTimeout = 0;
        this.timeoutAfterShow = 0;
        this.popperOnShown = new EventEmitter();
        this.popperOnHidden = new EventEmitter();
        this.popperOnUpdate = new EventEmitter();
        PopperController.baseOptions = tslib_1.__assign({}, PopperController.baseOptions, this.popperDefaults);
    }
    /**
     * @param {?} $event
     * @return {?}
     */
    PopperController.prototype.hideOnClickOutsideHandler = /**
     * @param {?} $event
     * @return {?}
     */
    function ($event) {
        if (this.disabled || !this.hideOnClickOutside || $event.srcElement &&
            $event.srcElement === this.popperContent.elemRef.nativeElement ||
            this.popperContent.elemRef.nativeElement.contains($event.srcElement)) {
            return;
        }
        this.scheduledHide($event, this.hideTimeout);
    };
    /**
     * @param {?} $event
     * @return {?}
     */
    PopperController.prototype.hideOnScrollHandler = /**
     * @param {?} $event
     * @return {?}
     */
    function ($event) {
        if (this.disabled || !this.hideOnScroll) {
            return;
        }
        this.scheduledHide($event, this.hideTimeout);
    };
    /**
     * @return {?}
     */
    PopperController.prototype.applyTriggerListeners = /**
     * @return {?}
     */
    function () {
        switch (this.showTrigger) {
            case Triggers.CLICK:
                this.eventListeners.push(this.renderer.listen(this.elementRef.nativeElement, 'click', this.toggle.bind(this)));
                break;
            case Triggers.MOUSEDOWN:
                this.eventListeners.push(this.renderer.listen(this.elementRef.nativeElement, 'mousedown', this.toggle.bind(this)));
                break;
            case Triggers.HOVER:
                this.eventListeners.push(this.renderer.listen(this.elementRef.nativeElement, 'mouseenter', this.scheduledShow.bind(this, this.showDelay)));
                this.eventListeners.push(this.renderer.listen(this.elementRef.nativeElement, 'touchend', this.scheduledHide.bind(this, null, this.hideTimeout)));
                this.eventListeners.push(this.renderer.listen(this.elementRef.nativeElement, 'touchcancel', this.scheduledHide.bind(this, null, this.hideTimeout)));
                this.eventListeners.push(this.renderer.listen(this.elementRef.nativeElement, 'mouseleave', this.scheduledHide.bind(this, null, this.hideTimeout)));
                break;
        }
        if (this.showTrigger !== Triggers.HOVER && this.hideOnMouseLeave) {
            this.eventListeners.push(this.renderer.listen(this.elementRef.nativeElement, 'touchend', this.scheduledHide.bind(this, null, this.hideTimeout)));
            this.eventListeners.push(this.renderer.listen(this.elementRef.nativeElement, 'touchcancel', this.scheduledHide.bind(this, null, this.hideTimeout)));
            this.eventListeners.push(this.renderer.listen(this.elementRef.nativeElement, 'mouseleave', this.scheduledHide.bind(this, null, this.hideTimeout)));
        }
    };
    /**
     * @param {?} target
     * @param {...?} sources
     * @return {?}
     */
    PopperController.assignDefined = /**
     * @param {?} target
     * @param {...?} sources
     * @return {?}
     */
    function (target) {
        var sources = [];
        for (var _i = 1; _i < arguments.length; _i++) {
            sources[_i - 1] = arguments[_i];
        }
        var e_1, _a, e_2, _b;
        try {
            for (var sources_1 = tslib_1.__values(sources), sources_1_1 = sources_1.next(); !sources_1_1.done; sources_1_1 = sources_1.next()) {
                var source = sources_1_1.value;
                try {
                    for (var _c = tslib_1.__values(Object.keys(source)), _d = _c.next(); !_d.done; _d = _c.next()) {
                        var key = _d.value;
                        /** @type {?} */
                        var val = source[key];
                        if (val !== undefined) {
                            target[key] = val;
                        }
                    }
                }
                catch (e_2_1) { e_2 = { error: e_2_1 }; }
                finally {
                    try {
                        if (_d && !_d.done && (_b = _c.return)) _b.call(_c);
                    }
                    finally { if (e_2) throw e_2.error; }
                }
            }
        }
        catch (e_1_1) { e_1 = { error: e_1_1 }; }
        finally {
            try {
                if (sources_1_1 && !sources_1_1.done && (_a = sources_1.return)) _a.call(sources_1);
            }
            finally { if (e_1) throw e_1.error; }
        }
        return target;
    };
    /**
     * @return {?}
     */
    PopperController.prototype.ngOnInit = /**
     * @return {?}
     */
    function () {
        //Support legacy prop
        this.hideOnClickOutside = typeof this.hideOnClickOutside === 'undefined' ?
            this.closeOnClickOutside : this.hideOnClickOutside;
        if (typeof this.content === 'string') {
            /** @type {?} */
            var text = this.content;
            this.popperContent = this.constructContent();
            this.popperContent.text = text;
        }
        else {
            this.popperContent = this.content;
        }
        /** @type {?} */
        var popperRef = this.popperContent;
        popperRef.referenceObject = this.getRefElement();
        this.setContentProperties(popperRef);
        this.setDefaults();
        this.applyTriggerListeners();
        if (this.showOnStart) {
            this.scheduledShow();
        }
    };
    /**
     * @param {?} changes
     * @return {?}
     */
    PopperController.prototype.ngOnChanges = /**
     * @param {?} changes
     * @return {?}
     */
    function (changes) {
        if (changes['popperDisabled'] && changes['popperDisabled'].currentValue) {
            this.hide();
        }
        if (changes['content']
            && !changes['content'].firstChange
            && typeof changes['content'].currentValue === 'string') {
            this.popperContent.text = changes['content'].currentValue;
        }
        if (changes['applyClass']
            && !changes['applyClass'].firstChange
            && typeof changes['applyClass'].currentValue === 'string') {
            this.popperContent.popperOptions.applyClass = changes['applyClass'].currentValue;
        }
        if (changes['applyArrowClass']
            && !changes['applyArrowClass'].firstChange
            && typeof changes['applyArrowClass'].currentValue === 'string') {
            this.popperContent.popperOptions.applyArrowClass = changes['applyArrowClass'].currentValue;
        }
    };
    /**
     * @return {?}
     */
    PopperController.prototype.ngOnDestroy = /**
     * @return {?}
     */
    function () {
        this.subscriptions.forEach(function (sub) { return sub.unsubscribe && sub.unsubscribe(); });
        this.subscriptions.length = 0;
        this.clearEventListeners();
        this.clearGlobalEventListeners();
        clearTimeout(this.scheduledShowTimeout);
        clearTimeout(this.scheduledHideTimeout);
        this.popperContent && this.popperContent.clean();
    };
    /**
     * @return {?}
     */
    PopperController.prototype.toggle = /**
     * @return {?}
     */
    function () {
        if (this.disabled) {
            return;
        }
        this.shown ? this.scheduledHide(null, this.hideTimeout) : this.scheduledShow();
    };
    /**
     * @return {?}
     */
    PopperController.prototype.show = /**
     * @return {?}
     */
    function () {
        if (this.shown) {
            this.overrideHideTimeout();
            return;
        }
        this.shown = true;
        /** @type {?} */
        var popperRef = this.popperContent;
        /** @type {?} */
        var element = this.getRefElement();
        if (popperRef.referenceObject !== element) {
            popperRef.referenceObject = element;
        }
        this.setContentProperties(popperRef);
        popperRef.show();
        this.popperOnShown.emit(this);
        if (this.timeoutAfterShow > 0) {
            this.scheduledHide(null, this.timeoutAfterShow);
        }
        this.globalEventListeners.push(this.renderer.listen('document', 'touchend', this.hideOnClickOutsideHandler.bind(this)));
        this.globalEventListeners.push(this.renderer.listen('document', 'click', this.hideOnClickOutsideHandler.bind(this)));
        this.globalEventListeners.push(this.renderer.listen(this.getScrollParent(this.getRefElement()), 'scroll', this.hideOnScrollHandler.bind(this)));
    };
    /**
     * @return {?}
     */
    PopperController.prototype.hide = /**
     * @return {?}
     */
    function () {
        if (this.disabled) {
            return;
        }
        if (!this.shown) {
            this.overrideShowTimeout();
            return;
        }
        this.shown = false;
        if (this.popperContentRef) {
            this.popperContentRef.instance.hide();
        }
        else {
            this.popperContent.hide();
        }
        this.popperOnHidden.emit(this);
        this.clearGlobalEventListeners();
    };
    /**
     * @param {?=} delay
     * @return {?}
     */
    PopperController.prototype.scheduledShow = /**
     * @param {?=} delay
     * @return {?}
     */
    function (delay) {
        var _this = this;
        if (delay === void 0) { delay = this.showDelay; }
        if (this.disabled) {
            return;
        }
        this.overrideHideTimeout();
        this.scheduledShowTimeout = setTimeout(function () {
            _this.show();
            _this.applyChanges();
        }, delay);
    };
    /**
     * @param {?=} $event
     * @param {?=} delay
     * @return {?}
     */
    PopperController.prototype.scheduledHide = /**
     * @param {?=} $event
     * @param {?=} delay
     * @return {?}
     */
    function ($event, delay) {
        var _this = this;
        if ($event === void 0) { $event = null; }
        if (delay === void 0) { delay = this.hideTimeout; }
        if (this.disabled) {
            return;
        }
        this.overrideShowTimeout();
        this.scheduledHideTimeout = setTimeout(function () {
            /** @type {?} */
            var toElement = $event ? $event.toElement : null;
            /** @type {?} */
            var popperContentView = _this.popperContent.popperViewRef ? _this.popperContent.popperViewRef.nativeElement : false;
            if (!popperContentView || popperContentView === toElement || popperContentView.contains(toElement) || ((/** @type {?} */ (_this.content))).isMouseOver) {
                return;
            }
            _this.hide();
            _this.applyChanges();
        }, delay);
    };
    /**
     * @return {?}
     */
    PopperController.prototype.getRefElement = /**
     * @return {?}
     */
    function () {
        return this.targetElement || this.viewContainerRef.element.nativeElement;
    };
    /**
     * @private
     * @return {?}
     */
    PopperController.prototype.applyChanges = /**
     * @private
     * @return {?}
     */
    function () {
        this.changeDetectorRef.markForCheck();
        this.changeDetectorRef.detectChanges();
    };
    /**
     * @private
     * @return {?}
     */
    PopperController.prototype.setDefaults = /**
     * @private
     * @return {?}
     */
    function () {
        this.showDelay = typeof this.showDelay === 'undefined' ? PopperController.baseOptions.showDelay : this.showDelay;
        this.showTrigger = typeof this.showTrigger === 'undefined' ? PopperController.baseOptions.trigger : this.showTrigger;
        this.hideOnClickOutside = typeof this.hideOnClickOutside === 'undefined' ? PopperController.baseOptions.hideOnClickOutside : this.hideOnClickOutside;
        this.hideOnScroll = typeof this.hideOnScroll === 'undefined' ? PopperController.baseOptions.hideOnScroll : this.hideOnScroll;
        this.hideOnMouseLeave = typeof this.hideOnMouseLeave === 'undefined' ? PopperController.baseOptions.hideOnMouseLeave : this.hideOnMouseLeave;
        this.ariaRole = typeof this.ariaRole === 'undefined' ? PopperController.baseOptions.ariaRole : this.ariaRole;
        this.ariaDescribe = typeof this.ariaDescribe === 'undefined' ? PopperController.baseOptions.ariaDescribe : this.ariaDescribe;
        this.styles = typeof this.styles === 'undefined' ? Object.assign({}, PopperController.baseOptions.styles) : this.styles;
    };
    /**
     * @private
     * @return {?}
     */
    PopperController.prototype.clearEventListeners = /**
     * @private
     * @return {?}
     */
    function () {
        this.eventListeners.forEach(function (evt) {
            evt && typeof evt === 'function' && evt();
        });
        this.eventListeners.length = 0;
    };
    /**
     * @private
     * @return {?}
     */
    PopperController.prototype.clearGlobalEventListeners = /**
     * @private
     * @return {?}
     */
    function () {
        this.globalEventListeners.forEach(function (evt) {
            evt && typeof evt === 'function' && evt();
        });
        this.globalEventListeners.length = 0;
    };
    /**
     * @private
     * @return {?}
     */
    PopperController.prototype.overrideShowTimeout = /**
     * @private
     * @return {?}
     */
    function () {
        if (this.scheduledShowTimeout) {
            clearTimeout(this.scheduledShowTimeout);
            this.scheduledHideTimeout = 0;
        }
    };
    /**
     * @private
     * @return {?}
     */
    PopperController.prototype.overrideHideTimeout = /**
     * @private
     * @return {?}
     */
    function () {
        if (this.scheduledHideTimeout) {
            clearTimeout(this.scheduledHideTimeout);
            this.scheduledHideTimeout = 0;
        }
    };
    /**
     * @private
     * @return {?}
     */
    PopperController.prototype.constructContent = /**
     * @private
     * @return {?}
     */
    function () {
        /** @type {?} */
        var factory = this.resolver.resolveComponentFactory(this.popperContentClass);
        this.popperContentRef = this.viewContainerRef.createComponent(factory);
        return (/** @type {?} */ (this.popperContentRef.instance));
    };
    /**
     * @private
     * @param {?} popperRef
     * @return {?}
     */
    PopperController.prototype.setContentProperties = /**
     * @private
     * @param {?} popperRef
     * @return {?}
     */
    function (popperRef) {
        popperRef.popperOptions = PopperController.assignDefined(popperRef.popperOptions, PopperController.baseOptions, {
            showDelay: this.showDelay,
            disableAnimation: this.disableAnimation,
            disableDefaultStyling: this.disableStyle,
            placement: this.placement,
            boundariesElement: this.boundariesElement,
            trigger: this.showTrigger,
            positionFixed: this.positionFixed,
            popperModifiers: this.popperModifiers,
            ariaDescribe: this.ariaDescribe,
            ariaRole: this.ariaRole,
            applyClass: this.applyClass,
            applyArrowClass: this.applyArrowClass,
            hideOnMouseLeave: this.hideOnMouseLeave,
            styles: this.styles,
            appendTo: this.appendTo,
            preventOverflow: this.preventOverflow,
        });
        popperRef.onUpdate = this.onPopperUpdate.bind(this);
        this.subscriptions.push(popperRef.onHidden.subscribe(this.hide.bind(this)));
    };
    /**
     * @private
     * @param {?} node
     * @return {?}
     */
    PopperController.prototype.getScrollParent = /**
     * @private
     * @param {?} node
     * @return {?}
     */
    function (node) {
        /** @type {?} */
        var isElement = node instanceof HTMLElement;
        /** @type {?} */
        var overflowY = isElement && window.getComputedStyle(node).overflowY;
        /** @type {?} */
        var isScrollable = overflowY !== 'visible' && overflowY !== 'hidden';
        if (!node) {
            return null;
        }
        else if (isScrollable && node.scrollHeight >= node.clientHeight) {
            return node;
        }
        return this.getScrollParent(node.parentNode) || document;
    };
    /**
     * @private
     * @param {?} event
     * @return {?}
     */
    PopperController.prototype.onPopperUpdate = /**
     * @private
     * @param {?} event
     * @return {?}
     */
    function (event) {
        this.popperOnUpdate.emit(event);
    };
    PopperController.baseOptions = (/** @type {?} */ ({
        showDelay: 0,
        placement: Placements.Auto,
        hideOnClickOutside: true,
        hideOnMouseLeave: false,
        hideOnScroll: false,
        showTrigger: Triggers.HOVER,
        appendTo: undefined,
        ariaRole: 'popper',
        ariaDescribe: '',
        styles: {}
    }));
    PopperController.decorators = [
        { type: Directive, args: [{
                    selector: '[popper]',
                    exportAs: 'popper'
                },] }
    ];
    /** @nocollapse */
    PopperController.ctorParameters = function () { return [
        { type: ViewContainerRef },
        { type: ChangeDetectorRef },
        { type: ComponentFactoryResolver },
        { type: ElementRef },
        { type: Renderer2 },
        { type: undefined, decorators: [{ type: Inject, args: ['popperDefaults',] }] }
    ]; };
    PopperController.propDecorators = {
        content: [{ type: Input, args: ['popper',] }],
        disabled: [{ type: Input, args: ['popperDisabled',] }],
        placement: [{ type: Input, args: ['popperPlacement',] }],
        showTrigger: [{ type: Input, args: ['popperTrigger',] }],
        targetElement: [{ type: Input, args: ['popperTarget',] }],
        showDelay: [{ type: Input, args: ['popperDelay',] }],
        hideTimeout: [{ type: Input, args: ['popperTimeout',] }],
        timeoutAfterShow: [{ type: Input, args: ['popperTimeoutAfterShow',] }],
        boundariesElement: [{ type: Input, args: ['popperBoundaries',] }],
        showOnStart: [{ type: Input, args: ['popperShowOnStart',] }],
        closeOnClickOutside: [{ type: Input, args: ['popperCloseOnClickOutside',] }],
        hideOnClickOutside: [{ type: Input, args: ['popperHideOnClickOutside',] }],
        hideOnScroll: [{ type: Input, args: ['popperHideOnScroll',] }],
        hideOnMouseLeave: [{ type: Input, args: ['popperHideOnMouseLeave',] }],
        positionFixed: [{ type: Input, args: ['popperPositionFixed',] }],
        popperModifiers: [{ type: Input, args: ['popperModifiers',] }],
        disableStyle: [{ type: Input, args: ['popperDisableStyle',] }],
        disableAnimation: [{ type: Input, args: ['popperDisableAnimation',] }],
        applyClass: [{ type: Input, args: ['popperApplyClass',] }],
        applyArrowClass: [{ type: Input, args: ['popperApplyArrowClass',] }],
        ariaDescribe: [{ type: Input, args: ['popperAriaDescribeBy',] }],
        ariaRole: [{ type: Input, args: ['popperAriaRole',] }],
        styles: [{ type: Input, args: ['popperStyles',] }],
        appendTo: [{ type: Input, args: ['popperAppendTo',] }],
        preventOverflow: [{ type: Input, args: ['popperPreventOverflow',] }],
        popperOnShown: [{ type: Output }],
        popperOnHidden: [{ type: Output }],
        popperOnUpdate: [{ type: Output }]
    };
    return PopperController;
}());
export { PopperController };
if (false) {
    /** @type {?} */
    PopperController.baseOptions;
    /**
     * @type {?}
     * @private
     */
    PopperController.prototype.popperContentClass;
    /**
     * @type {?}
     * @private
     */
    PopperController.prototype.popperContentRef;
    /**
     * @type {?}
     * @private
     */
    PopperController.prototype.shown;
    /**
     * @type {?}
     * @private
     */
    PopperController.prototype.scheduledShowTimeout;
    /**
     * @type {?}
     * @private
     */
    PopperController.prototype.scheduledHideTimeout;
    /**
     * @type {?}
     * @private
     */
    PopperController.prototype.subscriptions;
    /**
     * @type {?}
     * @private
     */
    PopperController.prototype.eventListeners;
    /**
     * @type {?}
     * @private
     */
    PopperController.prototype.globalEventListeners;
    /**
     * @type {?}
     * @private
     */
    PopperController.prototype.popperContent;
    /** @type {?} */
    PopperController.prototype.content;
    /** @type {?} */
    PopperController.prototype.disabled;
    /** @type {?} */
    PopperController.prototype.placement;
    /** @type {?} */
    PopperController.prototype.showTrigger;
    /** @type {?} */
    PopperController.prototype.targetElement;
    /** @type {?} */
    PopperController.prototype.showDelay;
    /** @type {?} */
    PopperController.prototype.hideTimeout;
    /** @type {?} */
    PopperController.prototype.timeoutAfterShow;
    /** @type {?} */
    PopperController.prototype.boundariesElement;
    /** @type {?} */
    PopperController.prototype.showOnStart;
    /** @type {?} */
    PopperController.prototype.closeOnClickOutside;
    /** @type {?} */
    PopperController.prototype.hideOnClickOutside;
    /** @type {?} */
    PopperController.prototype.hideOnScroll;
    /** @type {?} */
    PopperController.prototype.hideOnMouseLeave;
    /** @type {?} */
    PopperController.prototype.positionFixed;
    /** @type {?} */
    PopperController.prototype.popperModifiers;
    /** @type {?} */
    PopperController.prototype.disableStyle;
    /** @type {?} */
    PopperController.prototype.disableAnimation;
    /** @type {?} */
    PopperController.prototype.applyClass;
    /** @type {?} */
    PopperController.prototype.applyArrowClass;
    /** @type {?} */
    PopperController.prototype.ariaDescribe;
    /** @type {?} */
    PopperController.prototype.ariaRole;
    /** @type {?} */
    PopperController.prototype.styles;
    /** @type {?} */
    PopperController.prototype.appendTo;
    /** @type {?} */
    PopperController.prototype.preventOverflow;
    /** @type {?} */
    PopperController.prototype.popperOnShown;
    /** @type {?} */
    PopperController.prototype.popperOnHidden;
    /** @type {?} */
    PopperController.prototype.popperOnUpdate;
    /**
     * @type {?}
     * @private
     */
    PopperController.prototype.viewContainerRef;
    /**
     * @type {?}
     * @private
     */
    PopperController.prototype.changeDetectorRef;
    /**
     * @type {?}
     * @private
     */
    PopperController.prototype.resolver;
    /**
     * @type {?}
     * @private
     */
    PopperController.prototype.elementRef;
    /**
     * @type {?}
     * @private
     */
    PopperController.prototype.renderer;
    /**
     * @type {?}
     * @private
     */
    PopperController.prototype.popperDefaults;
}
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoicG9wcGVyLWRpcmVjdGl2ZS5qcyIsInNvdXJjZVJvb3QiOiJuZzovL25neC1wb3BwZXIvIiwic291cmNlcyI6WyJzcmMvcG9wcGVyLWRpcmVjdGl2ZS50cyJdLCJuYW1lcyI6W10sIm1hcHBpbmdzIjoiOzs7OztBQUFBLE9BQU8sRUFDTCxTQUFTLEVBRVQsZ0JBQWdCLEVBQ2hCLHdCQUF3QixFQUN4QixLQUFLLEVBR0wsTUFBTSxFQUVOLFlBQVksRUFBVSxTQUFTLEVBQUUsaUJBQWlCLEVBQUUsTUFBTSxFQUFFLFVBQVUsRUFDdkUsTUFBTSxlQUFlLENBQUM7QUFDdkIsT0FBTyxFQUFZLFVBQVUsRUFBaUMsUUFBUSxFQUFDLE1BQU0sZ0JBQWdCLENBQUM7QUFDOUYsT0FBTyxFQUFDLGFBQWEsRUFBQyxNQUFNLGtCQUFrQixDQUFDO0FBRS9DO0lBZUUsMEJBQW9CLGdCQUFrQyxFQUNsQyxpQkFBb0MsRUFDcEMsUUFBa0MsRUFDbEMsVUFBc0IsRUFDdEIsUUFBbUIsRUFDTyxjQUF5QztRQUF6QywrQkFBQSxFQUFBLG1CQUF5QztRQUxuRSxxQkFBZ0IsR0FBaEIsZ0JBQWdCLENBQWtCO1FBQ2xDLHNCQUFpQixHQUFqQixpQkFBaUIsQ0FBbUI7UUFDcEMsYUFBUSxHQUFSLFFBQVEsQ0FBMEI7UUFDbEMsZUFBVSxHQUFWLFVBQVUsQ0FBWTtRQUN0QixhQUFRLEdBQVIsUUFBUSxDQUFXO1FBQ08sbUJBQWMsR0FBZCxjQUFjLENBQTJCO1FBZi9FLHVCQUFrQixHQUFHLGFBQWEsQ0FBQztRQUVuQyxVQUFLLEdBQVksS0FBSyxDQUFDO1FBR3ZCLGtCQUFhLEdBQVUsRUFBRSxDQUFDO1FBQzFCLG1CQUFjLEdBQVUsRUFBRSxDQUFDO1FBQzNCLHlCQUFvQixHQUFVLEVBQUUsQ0FBQztRQTRDekMsZ0JBQVcsR0FBVyxDQUFDLENBQUM7UUFHeEIscUJBQWdCLEdBQVcsQ0FBQyxDQUFDO1FBc0Q3QixrQkFBYSxHQUFtQyxJQUFJLFlBQVksRUFBb0IsQ0FBQztRQUdyRixtQkFBYyxH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Qjs7SUFFMUIsdUNBQ3FCOztJQUVyQiwrQ0FDNkI7O0lBRTdCLDhDQUN3Qzs7SUFFeEMsd0NBQ2tDOztJQUVsQyw0Q0FDc0M7O0lBRXRDLHlDQUN1Qjs7SUFFdkIsMkNBQ29COztJQUVwQix3Q0FDc0I7O0lBRXRCLDRDQUMwQjs7SUFFMUIsc0NBQ21COztJQUVuQiwyQ0FDd0I7O0lBRXhCLHdDQUNpQzs7SUFFakMsb0NBQzZCOztJQUU3QixrQ0FDMkI7O0lBRTNCLG9DQUNpQjs7SUFFakIsMkNBQ3lCOztJQUV6Qix5Q0FDcUY7O0lBRXJGLDBDQUNzRjs7SUFFdEYsMENBQzREOzs7OztJQXhHaEQsNENBQTBDOzs7OztJQUMxQyw2Q0FBNEM7Ozs7O0lBQzVDLG9DQUEwQzs7Ozs7SUFDMUMsc0NBQThCOzs7OztJQUM5QixvQ0FBMkI7Ozs7O0lBQzNCLDBDQUEyRSIsInNvdXJjZXNDb250ZW50IjpbImltcG9ydCB7XG4gIERpcmVjdGl2ZSxcbiAgQ29tcG9uZW50UmVmLFxuICBWaWV3Q29udGFpbmVyUmVmLFxuICBDb21wb25lbnRGYWN0b3J5UmVzb2x2ZXIsXG4gIElucHV0LFxuICBPbkNoYW5nZXMsXG4gIFNpbXBsZUNoYW5nZSxcbiAgT3V0cHV0LFxuICBPbkRlc3Ryb3ksXG4gIEV2ZW50RW1pdHRlciwgT25Jbml0LCBSZW5kZXJlcjIsIENoYW5nZURldGVjdG9yUmVmLCBJbmplY3QsIEVsZW1lbnRSZWZcbn0gZnJvbSAnQGFuZ3VsYXIvY29yZSc7XG5pbXBvcnQge1BsYWNlbWVudCwgUGxhY2VtZW50cywgUG9wcGVyQ29udGVudE9wdGlvbnMsIFRyaWdnZXIsIFRyaWdnZXJzfSBmcm9tICcuL3BvcHBlci1tb2RlbCc7XG5pbXBvcnQge1BvcHBlckNvbnRlbnR9IGZyb20gJy4vcG9wcGVyLWNvbnRlbnQnO1xuXG5ARGlyZWN0aXZlKHtcbiAgc2VsZWN0b3I6ICdbcG9wcGVyXScsXG4gIGV4cG9ydEFzOiAncG9wcGVyJ1xufSlcbmV4cG9ydCBjbGFzcyBQb3BwZXJDb250cm9sbGVyIGltcGxlbWVudHMgT25Jbml0LCBPbkRlc3Ryb3ksIE9uQ2hhbmdlcyB7XG4gIHByaXZhdGUgcG9wcGVyQ29udGVudENsYXNzID0gUG9wcGVyQ29udGVudDtcbiAgcHJpdmF0ZSBwb3BwZXJDb250ZW50UmVmOiBDb21wb25lbnRSZWY8UG9wcGVyQ29udGVudD47XG4gIHByaXZhdGUgc2hvd246IGJvb2xlYW4gPSBmYWxzZTtcbiAgcHJpdmF0ZSBzY2hlZHVsZWRTaG93VGltZW91dDogYW55O1xuICBwcml2YXRlIHNjaGVkdWxlZEhpZGVUaW1lb3V0OiBhbnk7XG4gIHByaXZhdGUgc3Vic2NyaXB0aW9uczogYW55W10gPSBbXTtcbiAgcHJpdmF0ZSBldmVudExpc3RlbmVyczogYW55W10gPSBbXTtcbiAgcHJpdmF0ZSBnbG9iYWxFdmVudExpc3RlbmVyczogYW55W10gPSBbXTtcbiAgcHJpdmF0ZSBwb3BwZXJDb250ZW50OiBQb3BwZXJDb250ZW50O1xuXG4gIGNvbnN0cnVjdG9yKHByaXZhdGUgdmlld0NvbnRhaW5lclJlZjogVmlld0NvbnRhaW5lclJlZixcbiAgICAgICAgICAgICAgcHJpdmF0ZSBjaGFuZ2VEZXRlY3RvclJlZjogQ2hhbmdlRGV0ZWN0b3JSZWYsXG4gICAgICAgICAgICAgIHByaXZhdGUgcmVzb2x2ZXI6IENvbXBvbmVudEZhY3RvcnlSZXNvbHZlcixcbiAgICAgICAgICAgICAgcHJpdmF0ZSBlbGVtZW50UmVmOiBFbGVtZW50UmVmLFxuICAgICAgICAgICAgICBwcml2YXRlIHJlbmRlcmVyOiBSZW5kZXJlcjIsXG4gICAgICAgICAgICAgIEBJbmplY3QoJ3BvcHBlckRlZmF1bHRzJykgcHJpdmF0ZSBwb3BwZXJEZWZhdWx0czogUG9wcGVyQ29udGVudE9wdGlvbnMgPSB7fSkge1xuICAgIFBvcHBlckNvbnRyb2xsZXIuYmFzZU9wdGlvbnMgPSB7Li4uUG9wcGVyQ29udHJvbGxlci5iYXNlT3B0aW9ucywgLi4udGhpcy5wb3BwZXJEZWZhdWx0c307XG4gIH1cblxuICBwdWJsaWMgc3RhdGljIGJhc2VPcHRpb25zOiBQb3BwZXJDb250ZW50T3B0aW9ucyA9IDxQb3BwZXJDb250ZW50T3B0aW9ucz57XG4gICAgc2hvd0RlbGF5OiAwLFxuICAgIHBsYWNlbWVudDogUGxhY2VtZW50cy5BdXRvLFxuICAgIGhpZGVPbkNsaWNrT3V0c2lkZTogdHJ1ZSxcbiAgICBoaWRlT25Nb3VzZUxlYXZlOiBmYWxzZSxcbiAgICBoaWRlT25TY3JvbGw6IGZhbHNlLFxuICAgIHNob3dUcmlnZ2VyOiBUcmlnZ2Vycy5IT1ZFUixcbiAgICBhcHBlbmRUbzogdW5kZWZpbmVkLFxuICAgIGFyaWFSb2xlOiAncG9wcGVyJyxcbiAgICBhcmlhRGVzY3JpYmU6ICcnLFxuICAgIHN0eWxlczoge31cbiAgfTtcblxuICBASW5wdXQoJ3BvcHBlcicpXG4gIGNvbnRlbnQ6IHN0cmluZyB8IFBvcHBlckNvbnRlbnQ7XG5cbiAgQElucHV0KCdwb3BwZXJEaXNhYmxlZCcpXG4gIGRpc2FibGVkOiBib29sZWFuO1xuXG4gIEBJbnB1dCgncG9wcGVyUGxhY2VtZW50JylcbiAgcGxhY2VtZW50OiBQbGFjZW1lbnQ7XG5cbiAgQElucHV0KCdwb3BwZXJUcmlnZ2VyJylcbiAgc2hvd1RyaWdnZXI6IFRyaWdnZXIgfCB1bmRlZmluZWQ7XG5cbiAgQElucHV0KCdwb3BwZXJUYXJnZXQnKVxuICB0YXJnZXRFbGVtZW50OiBIVE1MRWxlbWVudDtcblxuICBASW5wdXQoJ3BvcHBlckRlbGF5JylcbiAgc2hvd0RlbGF5OiBudW1iZXIgfCB1bmRlZmluZWQ7XG5cbiAgQElucHV0KCdwb3BwZXJUaW1lb3V0JylcbiAgaGlkZVRpbWVvdXQ6IG51bWJlciA9IDA7XG5cbiAgQElucHV0KCdwb3BwZXJUaW1lb3V0QWZ0ZXJTaG93JylcbiAgdGltZW91dEFmdGVyU2hvdzogbnVtYmVyID0gMDtcblxuICBASW5wdXQoJ3BvcHBlckJvdW5kYXJpZXMnKVxuICBib3VuZGFyaWVzRWxlbWVudDogc3RyaW5nO1xuXG4gIEBJbnB1dCgncG9wcGVyU2hvd09uU3RhcnQnKVxuICBzaG93T25TdGFydDogYm9vbGVhbjtcblxuICBASW5wdXQoJ3BvcHBlckNsb3NlT25DbGlja091dHNpZGUnKVxuICBjbG9zZU9uQ2xpY2tPdXRzaWRlOiBib29sZWFuO1xuXG4gIEBJbnB1dCgncG9wcGVySGlkZU9uQ2xpY2tPdXRzaWRlJylcbiAgaGlkZU9uQ2xpY2tPdXRzaWRlOiBib29sZWFuIHwgdW5kZWZpbmVkO1xuXG4gIEBJbnB1dCgncG9wcGVySGlkZU9uU2Nyb2xsJylcbiAgaGlkZU9uU2Nyb2xsOiBib29sZWFuIHwgdW5kZWZpbmVkO1xuXG4gIEBJbnB1dCgncG9wcGVySGlkZU9uTW91c2VMZWF2ZScpXG4gIGhpZGVPbk1vdXNlTGVhdmU6IGJvb2xlYW4gfCB1bmRlZmluZWQ7XG5cbiAgQElucHV0KCdwb3BwZXJQb3NpdGlvbkZpeGVkJylcbiAgcG9zaXRpb25GaXhlZDogYm9vbGVhbjtcblxuICBASW5wdXQoJ3BvcHBlck1vZGlmaWVycycpXG4gIHBvcHBlck1vZGlmaWVyczoge307XG5cbiAgQElucHV0KCdwb3BwZXJEaXNhYmxlU3R5bGUnKVxuICBkaXNhYmxlU3R5bGU6IGJvb2xlYW47XG5cbiAgQElucHV0KCdwb3BwZXJEaXNhYmxlQW5pbWF0aW9uJylcbiAgZGlzYWJsZUFuaW1hdGlvbjogYm9vbGVhbjtcblxuICBASW5wdXQoJ3BvcHBlckFwcGx5Q2xhc3MnKVxuICBhcHBseUNsYXNzOiBzdHJpbmc7XG5cbiAgQElucHV0KCdwb3BwZXJBcHBseUFycm93Q2xhc3MnKVxuICBhcHBseUFycm93Q2xhc3M6IHN0cmluZztcblxuICBASW5wdXQoJ3BvcHBlckFyaWFEZXNjcmliZUJ5JylcbiAgYXJpYURlc2NyaWJlOiBzdHJpbmcgfCB1bmRlZmluZWQ7XG5cbiAgQElucHV0KCdwb3BwZXJBcmlhUm9sZScpXG4gIGFyaWFSb2xlOiBzdHJpbmcgfCB1bmRlZmluZWQ7XG5cbiAgQElucHV0KCdwb3BwZXJTdHlsZXMnKVxuICBzdHlsZXM6IE9iamVjdCB8IHVuZGVmaW5lZDtcblxuICBASW5wdXQoJ3BvcHBlckFwcGVuZFRvJylcbiAgYXBwZW5kVG86IHN0cmluZztcblxuICBASW5wdXQoJ3BvcHBlclByZXZlbnRPdmVyZmxvdycpXG4gIHByZXZlbnRPdmVyZmxvdzogYm9vbGVhbjtcblxuICBAT3V0cHV0KClcbiAgcG9wcGVyT25TaG93bjogRXZlbnRFbWl0dGVyPFBvcHBlckNvbnRyb2xsZXI+ID0gbmV3IEV2ZW50RW1pdHRlcjxQb3BwZXJDb250cm9sbGVyPigpO1xuXG4gIEBPdXRwdXQoKVxuICBwb3BwZXJPbkhpZGRlbjogRXZlbnRFbWl0dGVyPFBvcHBlckNvbnRyb2xsZXI+ID0gbmV3IEV2ZW50RW1pdHRlcjxQb3BwZXJDb250cm9sbGVyPigpO1xuXG4gIEBPdXRwdXQoKVxuICBwb3BwZXJPblVwZGF0ZTogRXZlbnRFbWl0dGVyPGFueT4gPSBuZXcgRXZlbnRFbWl0dGVyPGFueT4oKTtcblxuICBoaWRlT25DbGlja091dHNpZGVIYW5kbGVyKCRldmVudDogTW91c2VFdmVudCk6IHZvaWQge1xuICAgIGlmICh0aGlzLmRpc2FibGVkIHx8ICF0aGlzLmhpZGVPbkNsaWNrT3V0c2lkZSB8fCAkZXZlbnQuc3JjRWxlbWVudCAmJlxuICAgICAgJGV2ZW50LnNyY0VsZW1lbnQgPT09IHRoaXMucG9wcGVyQ29udGVudC5lbGVtUmVmLm5hdGl2ZUVsZW1lbnQgfHxcbiAgICAgIHRoaXMucG9wcGVyQ29udGVudC5lbGVtUmVmLm5hdGl2ZUVsZW1lbnQuY29udGFpbnMoJGV2ZW50LnNyY0VsZW1lbnQpKSB7XG4gICAgICByZXR1cm47XG4gICAgfVxuICAgIHRoaXMuc2NoZWR1bGVkSGlkZSgkZXZlbnQsIHRoaXMuaGlkZVRpbWVvdXQpO1xuICB9XG5cbiAgaGlkZU9uU2Nyb2xsSGFuZGxlcigkZXZlbnQ6IE1vdXNlRXZlbnQpOiB2b2lkIHtcbiAgICBpZiAodGhpcy5kaXNhYmxlZCB8fCAhdGhpcy5oaWRlT25TY3JvbGwpIHtcbiAgICAgIHJldHVybjtcbiAgICB9XG4gICAgdGhpcy5zY2hlZHVsZWRIaWRlKCRldmVudCwgdGhpcy5oaWRlVGltZW91dCk7XG4gIH1cblxuICBhcHBseVRyaWdnZXJMaXN0ZW5lcnMoKSB7XG4gICAgc3dpdGNoICh0aGlzLnNob3dUcmlnZ2VyKSB7XG4gICAgICBjYXNlIFRyaWdnZXJzLkNMSUNLOlxuICAgICAgICB0aGlzLmV2ZW50TGlzdGVuZXJzLnB1c2godGhpcy5yZW5kZXJlci5saXN0ZW4odGhpcy5lbGVtZW50UmVmLm5hdGl2ZUVsZW1lbnQsICdjbGljaycsIHRoaXMudG9nZ2xlLmJpbmQodGhpcykpKTtcbiAgICAgICAgYnJlYWs7XG4gICAgICBjYXNlIFRyaWdnZXJzLk1PVVNFRE9XTjpcbiAgICAgICAgdGhpcy5ldmVudExpc3RlbmVycy5wdXNoKHRoaXMucmVuZGVyZXIubGlzdGVuKHRoaXMuZWxlbWVudFJlZi5uYXRpdmVFbGVtZW50LCAnbW91c2Vkb3duJywgdGhpcy50b2dnbGUuYmluZCh0aGlzKSkpO1xuICAgICAgICBicmVhaztcbiAgICAgIGNhc2UgVHJpZ2dlcnMuSE9WRVI6XG4gICAgICAgIHRoaXMuZXZlbnRMaXN0ZW5lcnMucHVzaCh0aGlzLnJlbmRlcmVyLmxpc3Rlbih0aGlzLmVsZW1lbnRSZWYubmF0aXZlRWxlbWVudCwgJ21vdXNlZW50ZXInLCB0aGlzLnNjaGVkdWxlZFNob3cuYmluZCh0aGlzLCB0aGlzLnNob3dEZWxheSkpKTtcbiAgICAgICAgdGhpcy5ldmVudExpc3RlbmVycy5wdXNoKHRoaXMucmVuZGVyZXIubGlzdGVuKHRoaXMuZWxlbWVudFJlZi5uYXRpdmVFbGVtZW50LCAndG91Y2hlbmQnLCB0aGlzLnNjaGVkdWxlZEhpZGUuYmluZCh0aGlzLCBudWxsLCB0aGlzLmhpZGVUaW1lb3V0KSkpO1xuICAgICAgICB0aGlzLmV2ZW50TGlzdGVuZXJzLnB1c2godGhpcy5yZW5kZXJlci5saXN0ZW4odGhpcy5lbGVtZW50UmVmLm5hdGl2ZUVsZW1lbnQsICd0b3VjaGNhbmNlbCcsIHRoaXMuc2NoZWR1bGVkSGlkZS5iaW5kKHRoaXMsIG51bGwsIHRoaXMuaGlkZVRpbWVvdXQpKSk7XG4gICAgICAgIHRoaXMuZXZlbnRMaXN0ZW5lcnMucHVzaCh0aGlzLnJlbmRlcmVyLmxpc3Rlbih0aGlzLmVsZW1lbnRSZWYubmF0aXZlRWxlbWVudCwgJ21vdXNlbGVhdmUnLCB0aGlzLnNjaGVkdWxlZEhpZGUuYmluZCh0aGlzLCBudWxsLCB0aGlzLmhpZGVUaW1lb3V0KSkpO1xuICAgICAgICBicmVhaztcbiAgICB9XG4gICAgaWYgKHRoaXMuc2hvd1RyaWdnZXIgIT09IFRyaWdnZXJzLkhPVkVSICYmIHRoaXMuaGlkZU9uTW91c2VMZWF2ZSkge1xuICAgICAgdGhpcy5ldmVudExpc3RlbmVycy5wdXNoKHRoaXMucmVuZGVyZXIubGlzdGVuKHRoaXMuZWxlbWVudFJlZi5uYXRpdmVFbGVtZW50LCAndG91Y2hlbmQnLCB0aGlzLnNjaGVkdWxlZEhpZGUuYmluZCh0aGlzLCBudWxsLCB0aGlzLmhpZGVUaW1lb3V0KSkpO1xuICAgICAgdGhpcy5ldmVudExpc3RlbmVycy5wdXNoKHRoaXMucmVuZGVyZXIubGlzdGVuKHRoaXMuZWxlbWVudFJlZi5uYXRpdmVFbGVtZW50LCAndG91Y2hjYW5jZWwnLCB0aGlzLnNjaGVkdWxlZEhpZGUuYmluZCh0aGlzLCBudWxsLCB0aGlzLmhpZGVUaW1lb3V0KSkpO1xuICAgICAgdGhpcy5ldmVudExpc3RlbmVycy5wdXNoKHRoaXMucmVuZGVyZXIubGlzdGVuKHRoaXMuZWxlbWVudFJlZi5uYXRpdmVFbGVtZW50LCAnbW91c2VsZWF2ZScsIHRoaXMuc2NoZWR1bGVkSGlkZS5iaW5kKHRoaXMsIG51bGwsIHRoaXMuaGlkZVRpbWVvdXQpKSk7XG4gICAgfVxuICB9XG5cbiAgc3RhdGljIGFzc2lnbkRlZmluZWQodGFyZ2V0OiBhbnksIC4uLnNvdXJjZXM6IGFueVtdKSB7XG4gICAgZm9yIChjb25zdCBzb3VyY2Ugb2Ygc291cmNlcykge1xuICAgICAgZm9yIChjb25zdCBrZXkgb2YgT2JqZWN0LmtleXMoc291cmNlKSkge1xuICAgICAgICBjb25zdCB2YWwgPSBzb3VyY2Vba2V5XTtcbiAgICAgICAgaWYgKHZhbCAhPT0gdW5kZWZpbmVkKSB7XG4gICAgICAgICAgdGFyZ2V0W2tleV0gPSB2YWw7XG4gICAgICAgIH1cbiAgICAgIH1cbiAgICB9XG4gICAgcmV0dXJuIHRhcmdldDtcbiAgfVxuXG4gIG5nT25Jbml0KCkge1xuICAgIC8vU3VwcG9ydCBsZWdhY3kgcHJvcFxuICAgIHRoaXMuaGlkZU9uQ2xpY2tPdXRzaWRlID0gdHlwZW9mIHRoaXMuaGlkZU9uQ2xpY2tPdXRzaWRlID09PSAndW5kZWZpbmVkJyA/XG4gICAgICB0aGlzLmNsb3NlT25DbGlja091dHNpZGUgOiB0aGlzLmhpZGVPbkNsaWNrT3V0c2lkZTtcblxuICAgIGlmICh0eXBlb2YgdGhpcy5jb250ZW50ID09PSAnc3RyaW5nJykge1xuICAgICAgY29uc3QgdGV4dCA9IHRoaXMuY29udGVudDtcbiAgICAgIHRoaXMucG9wcGVyQ29udGVudCA9IHRoaXMuY29uc3RydWN0Q29udGVudCgpO1xuICAgICAgdGhpcy5wb3BwZXJDb250ZW50LnRleHQgPSB0ZXh0O1xuICAgIH1cbiAgICBlbHNlIHtcbiAgICAgIHRoaXMucG9wcGVyQ29udGVudCA9IHRoaXMuY29udGVudDtcbiAgICB9XG4gICAgY29uc3QgcG9wcGVyUmVmID0gdGhpcy5wb3BwZXJDb250ZW50O1xuICAgIHBvcHBlclJlZi5yZWZlcmVuY2VPYmplY3QgPSB0aGlzLmdldFJlZkVsZW1lbnQoKTtcbiAgICB0aGlzLnNldENvbnRlbnRQcm9wZXJ0aWVzKHBvcHBlclJlZik7XG4gICAgdGhpcy5zZXREZWZhdWx0cygpO1xuICAgIHRoaXMuYXBwbHlUcmlnZ2VyTGlzdGVuZXJzKCk7XG4gICAgaWYgKHRoaXMuc2hvd09uU3RhcnQpIHtcbiAgICAgIHRoaXMuc2NoZWR1bGVkU2hvdygpO1xuICAgIH1cbiAgfVxuXG4gIG5nT25DaGFuZ2VzKGNoYW5nZXM6IHsgW3Byb3BlcnR5TmFtZTogc3RyaW5nXTogU2ltcGxlQ2hhbmdlIH0pIHtcbiAgICBpZiAoY2hhbmdlc1sncG9wcGVyRGlzYWJsZWQnXSAmJiBjaGFuZ2VzWydwb3BwZXJEaXNhYmxlZCddLmN1cnJlbnRWYWx1ZSkge1xuICAgICAgdGhpcy5oaWRlKCk7XG4gICAgfVxuICAgIGlmIChjaGFuZ2VzWydjb250ZW50J11cbiAgICAgICYmICFjaGFuZ2VzWydjb250ZW50J10uZmlyc3RDaGFuZ2VcbiAgICAgICYmIHR5cGVvZiBjaGFuZ2VzWydjb250ZW50J10uY3VycmVudFZhbHVlID09PSAnc3RyaW5nJykge1xuICAgICAgdGhpcy5wb3BwZXJDb250ZW50LnRleHQgPSBjaGFuZ2VzWydjb250ZW50J10uY3VycmVudFZhbHVlO1xuICAgIH1cblxuICAgIGlmIChjaGFuZ2VzWydhcHBseUNsYXNzJ11cbiAgICAgICYmICFjaGFuZ2VzWydhcHBseUNsYXNzJ10uZmlyc3RDaGFuZ2VcbiAgICAgICYmIHR5cGVvZiBjaGFuZ2VzWydhcHBseUNsYXNzJ10uY3VycmVudFZhbHVlID09PSAnc3RyaW5nJykge1xuICAgICAgdGhpcy5wb3BwZXJDb250ZW50LnBvcHBlck9wdGlvbnMuYXBwbHlDbGFzcyA9IGNoYW5nZXNbJ2FwcGx5Q2xhc3MnXS5jdXJyZW50VmFsdWU7XG4gICAgfVxuXG4gICAgaWYgKGNoYW5nZXNbJ2FwcGx5QXJyb3dDbGFzcyddXG4gICAgICAmJiAhY2hhbmdlc1snYXBwbHlBcnJvd0NsYXNzJ10uZmlyc3RDaGFuZ2VcbiAgICAgICYmIHR5cGVvZiBjaGFuZ2VzWydhcHBseUFycm93Q2xhc3MnXS5jdXJyZW50VmFsdWUgPT09ICdzdHJpbmcnKSB7XG4gICAgICB0aGlzLnBvcHBlckNvbnRlbnQucG9wcGVyT3B0aW9ucy5hcHBseUFycm93Q2xhc3MgPSBjaGFuZ2VzWydhcHBseUFycm93Q2xhc3MnXS5jdXJyZW50VmFsdWU7XG4gICAgfVxuICB9XG5cbiAgbmdPbkRlc3Ryb3koKSB7XG4gICAgdGhpcy5zdWJzY3JpcHRpb25zLmZvckVhY2goc3ViID0+IHN1Yi51bnN1YnNjcmliZSAmJiBzdWIudW5zdWJzY3JpYmUoKSk7XG4gICAgdGhpcy5zdWJzY3JpcHRpb25zLmxlbmd0aCA9IDA7XG4gICAgdGhpcy5jbGVhckV2ZW50TGlzdGVuZXJzKCk7XG4gICAgdGhpcy5jbGVhckdsb2JhbEV2ZW50TGlzdGVuZXJzKCk7XG4gICAgY2xlYXJUaW1lb3V0KHRoaXMuc2NoZWR1bGVkU2hvd1RpbWVvdXQpO1xuICAgIGNsZWFyVGltZW91dCh0aGlzLnNjaGVkdWxlZEhpZGVUaW1lb3V0KTtcbiAgICB0aGlzLnBvcHBlckNvbnRlbnQgJiYgdGhpcy5wb3BwZXJDb250ZW50LmNsZWFuKCk7XG4gIH1cblxuICB0b2dnbGUoKSB7XG4gICAgaWYgKHRoaXMuZGlzYWJsZWQpIHtcbiAgICAgIHJldHVybjtcbiAgICB9XG4gICAgdGhpcy5zaG93biA/IHRoaXMuc2NoZWR1bGVkSGlkZShudWxsLCB0aGlzLmhpZGVUaW1lb3V0KSA6IHRoaXMuc2NoZWR1bGVkU2hvdygpO1xuICB9XG5cbiAgc2hvdygpIHtcbiAgICBpZiAodGhpcy5zaG93bikge1xuICAgICAgdGhpcy5vdmVycmlkZUhpZGVUaW1lb3V0KCk7XG4gICAgICByZXR1cm47XG4gICAgfVxuXG4gICAgdGhpcy5zaG93biA9IHRydWU7XG4gICAgY29uc3QgcG9wcGVyUmVmID0gdGhpcy5wb3BwZXJDb250ZW50O1xuICAgIGNvbnN0IGVsZW1lbnQgPSB0aGlzLmdldFJlZkVsZW1lbnQoKTtcbiAgICBpZiAocG9wcGVyUmVmLnJlZmVyZW5jZU9iamVjdCAhPT0gZWxlbWVudCkge1xuICAgICAgcG9wcGVyUmVmLnJlZmVyZW5jZU9iamVjdCA9IGVsZW1lbnQ7XG4gICAgfVxuICAgIHRoaXMuc2V0Q29udGVudFByb3BlcnRpZXMocG9wcGVyUmVmKTtcbiAgICBwb3BwZXJSZWYuc2hvdygpO1xuICAgIHRoaXMucG9wcGVyT25TaG93bi5lbWl0KHRoaXMpO1xuICAgIGlmICh0aGlzLnRpbWVvdXRBZnRlclNob3cgPiAwKSB7XG4gICAgICB0aGlzLnNjaGVkdWxlZEhpZGUobnVsbCwgdGhpcy50aW1lb3V0QWZ0ZXJTaG93KTtcbiAgICB9XG4gICAgdGhpcy5nbG9iYWxFdmVudExpc3RlbmVycy5wdXNoKHRoaXMucmVuZGVyZXIubGlzdGVuKCdkb2N1bWVudCcsICd0b3VjaGVuZCcsIHRoaXMuaGlkZU9uQ2xpY2tPdXRzaWRlSGFuZGxlci5iaW5kKHRoaXMpKSk7XG4gICAgdGhpcy5nbG9iYWxFdmVudExpc3RlbmVycy5wdXNoKHRoaXMucmVuZGVyZXIubGlzdGVuKCdkb2N1bWVudCcsICdjbGljaycsIHRoaXMuaGlkZU9uQ2xpY2tPdXRzaWRlSGFuZGxlci5iaW5kKHRoaXMpKSk7XG4gICAgdGhpcy5nbG9iYWxFdmVudExpc3RlbmVycy5wdXNoKHRoaXMucmVuZGVyZXIubGlzdGVuKHRoaXMuZ2V0U2Nyb2xsUGFyZW50KHRoaXMuZ2V0UmVmRWxlbWVudCgpKSwgJ3Njcm9sbCcsIHRoaXMuaGlkZU9uU2Nyb2xsSGFuZGxlci5iaW5kKHRoaXMpKSk7XG4gIH1cblxuICBoaWRlKCkge1xuICAgIGlmICh0aGlzLmRpc2FibGVkKSB7XG4gICAgICByZXR1cm47XG4gICAgfVxuICAgIGlmICghdGhpcy5zaG93bikge1xuICAgICAgdGhpcy5vdmVycmlkZVNob3dUaW1lb3V0KCk7XG4gICAgICByZXR1cm47XG4gICAgfVxuXG4gICAgdGhpcy5zaG93biA9IGZhbHNlO1xuICAgIGlmICh0aGlzLnBvcHBlckNvbnRlbnRSZWYpIHtcbiAgICAgIHRoaXMucG9wcGVyQ29udGVudFJlZi5pbnN0YW5jZS5oaWRlKCk7XG4gICAgfVxuICAgIGVsc2Uge1xuICAgICAgdGhpcy5wb3BwZXJDb250ZW50LmhpZGUoKTtcbiAgICB9XG4gICAgdGhpcy5wb3BwZXJPbkhpZGRlbi5lbWl0KHRoaXMpO1xuICAgIHRoaXMuY2xlYXJHbG9iYWxFdmVudExpc3RlbmVycygpO1xuICB9XG5cbiAgc2NoZWR1bGVkU2hvdyhkZWxheTogbnVtYmVyIHwgdW5kZWZpbmVkID0gdGhpcy5zaG93RGVsYXkpIHtcbiAgICBpZiAodGhpcy5kaXNhYmxlZCkge1xuICAgICAgcmV0dXJuO1xuICAgIH1cbiAgICB0aGlzLm92ZXJyaWRlSGlkZVRpbWVvdXQoKTtcbiAgICB0aGlzLnNjaGVkdWxlZFNob3dUaW1lb3V0ID0gc2V0VGltZW91dCgoKSA9PiB7XG4gICAgICB0aGlzLnNob3coKTtcbiAgICAgIHRoaXMuYXBwbHlDaGFuZ2VzKCk7XG4gICAgfSwgZGVsYXkpXG4gIH1cblxuICBzY2hlZHVsZWRIaWRlKCRldmVudDogYW55ID0gbnVsbCwgZGVsYXk6IG51bWJlciA9IHRoaXMuaGlkZVRpbWVvdXQpIHtcbiAgICBpZiAodGhpcy5kaXNhYmxlZCkge1xuICAgICAgcmV0dXJuO1xuICAgIH1cbiAgICB0aGlzLm92ZXJyaWRlU2hvd1RpbWVvdXQoKTtcbiAgICB0aGlzLnNjaGVkdWxlZEhpZGVUaW1lb3V0ID0gc2V0VGltZW91dCgoKSA9PiB7XG4gICAgICBjb25zdCB0b0VsZW1lbnQgPSAkZXZlbnQgPyAkZXZlbnQudG9FbGVtZW50IDogbnVsbDtcbiAgICAgIGNvbnN0IHBvcHBlckNvbnRlbnRWaWV3ID0gdGhpcy5wb3BwZXJDb250ZW50LnBvcHBlclZpZXdSZWYgPyB0aGlzLnBvcHBlckNvbnRlbnQucG9wcGVyVmlld1JlZi5uYXRpdmVFbGVtZW50IDogZmFsc2U7XG4gICAgICBpZiAoIXBvcHBlckNvbnRlbnRWaWV3IHx8IHBvcHBlckNvbnRlbnRWaWV3ID09PSB0b0VsZW1lbnQgfHwgcG9wcGVyQ29udGVudFZpZXcuY29udGFpbnModG9FbGVtZW50KSB8fCAodGhpcy5jb250ZW50IGFzIFBvcHBlckNvbnRlbnQpLmlzTW91c2VPdmVyKSB7XG4gICAgICAgIHJldHVybjtcbiAgICAgIH1cbiAgICAgIHRoaXMuaGlkZSgpO1xuICAgICAgdGhpcy5hcHBseUNoYW5nZXMoKTtcbiAgICB9LCBkZWxheSk7XG4gIH1cblxuICBnZXRSZWZFbGVtZW50KCkge1xuICAgIHJldHVybiB0aGlzLnRhcmdldEVsZW1lbnQgfHwgdGhpcy52aWV3Q29udGFpbmVyUmVmLmVsZW1lbnQubmF0aXZlRWxlbWVudDtcbiAgfVxuXG4gIHByaXZhdGUgYXBwbHlDaGFuZ2VzKCkge1xuICAgIHRoaXMuY2hhbmdlRGV0ZWN0b3JSZWYubWFya0ZvckNoZWNrKCk7XG4gICAgdGhpcy5jaGFuZ2VEZXRlY3RvclJlZi5kZXRlY3RDaGFuZ2VzKCk7XG4gIH1cblxuICBwcml2YXRlIHNldERlZmF1bHRzKCkge1xuICAgIHRoaXMuc2hvd0RlbGF5ID0gdHlwZW9mIHRoaXMuc2hvd0RlbGF5ID09PSAndW5kZWZpbmVkJyA/IFBvcHBlckNvbnRyb2xsZXIuYmFzZU9wdGlvbnMuc2hvd0RlbGF5IDogdGhpcy5zaG93RGVsYXk7XG4gICAgdGhpcy5zaG93VHJpZ2dlciA9IHR5cGVvZiB0aGlzLnNob3dUcmlnZ2VyID09PSAndW5kZWZpbmVkJyA/IFBvcHBlckNvbnRyb2xsZXIuYmFzZU9wdGlvbnMudHJpZ2dlciA6IHRoaXMuc2hvd1RyaWdnZXI7XG4gICAgdGhpcy5oaWRlT25DbGlja091dHNpZGUgPSB0eXBlb2YgdGhpcy5oaWRlT25DbGlja091dHNpZGUgPT09ICd1bmRlZmluZWQnID8gUG9wcGVyQ29udHJvbGxlci5iYXNlT3B0aW9ucy5oaWRlT25DbGlja091dHNpZGUgOiB0aGlzLmhpZGVPbkNsaWNrT3V0c2lkZTtcbiAgICB0aGlzLmhpZGVPblNjcm9sbCA9IHR5cGVvZiB0aGlzLmhpZGVPblNjcm9sbCA9PT0gJ3VuZGVmaW5lZCcgPyBQb3BwZXJDb250cm9sbGVyLmJhc2VPcHRpb25zLmhpZGVPblNjcm9sbCA6IHRoaXMuaGlkZU9uU2Nyb2xsO1xuICAgIHRoaXMuaGlkZU9uTW91c2VMZWF2ZSA9IHR5cGVvZiB0aGlzLmhpZGVPbk1vdXNlTGVhdmUgPT09ICd1bmRlZmluZWQnID8gUG9wcGVyQ29udHJvbGxlci5iYXNlT3B0aW9ucy5oaWRlT25Nb3VzZUxlYXZlIDogdGhpcy5oaWRlT25Nb3VzZUxlYXZlO1xuICAgIHRoaXMuYXJpYVJvbGUgPSB0eXBlb2YgdGhpcy5hcmlhUm9sZSA9PT0gJ3VuZGVmaW5lZCcgPyBQb3BwZXJDb250cm9sbGVyLmJhc2VPcHRpb25zLmFyaWFSb2xlIDogdGhpcy5hcmlhUm9sZTtcbiAgICB0aGlzLmFyaWFEZXNjcmliZSA9IHR5cGVvZiB0aGlzLmFyaWFEZXNjcmliZSA9PT0gJ3VuZGVmaW5lZCcgPyBQb3BwZXJDb250cm9sbGVyLmJhc2VPcHRpb25zLmFyaWFEZXNjcmliZSA6IHRoaXMuYXJpYURlc2NyaWJlO1xuICAgIHRoaXMuc3R5bGVzID0gdHlwZW9mIHRoaXMuc3R5bGVzID09PSAndW5kZWZpbmVkJyA/IE9iamVjdC5hc3NpZ24oe30sIFBvcHBlckNvbnRyb2xsZXIuYmFzZU9wdGlvbnMuc3R5bGVzKSA6IHRoaXMuc3R5bGVzO1xuICB9XG5cbiAgcHJpdmF0ZSBjbGVhckV2ZW50TGlzdGVuZXJzKCkge1xuICAgIHRoaXMuZXZlbnRMaXN0ZW5lcnMuZm9yRWFjaChldnQgPT4ge1xuICAgICAgZXZ0ICYmIHR5cGVvZiBldnQgPT09ICdmdW5jdGlvbicgJiYgZXZ0KCk7XG4gICAgfSk7XG4gICAgdGhpcy5ldmVudExpc3RlbmVycy5sZW5ndGggPSAwO1xuICB9XG5cbiAgcHJpdmF0ZSBjbGVhckdsb2JhbEV2ZW50TGlzdGVuZXJzKCkge1xuICAgIHRoaXMuZ2xvYmFsRXZlbnRMaXN0ZW5lcnMuZm9yRWFjaChldnQgPT4ge1xuICAgICAgZXZ0ICYmIHR5cGVvZiBldnQgPT09ICdmdW5jdGlvbicgJiYgZXZ0KCk7XG4gICAgfSk7XG4gICAgdGhpcy5nbG9iYWxFdmVudExpc3RlbmVycy5sZW5ndGggPSAwO1xuICB9XG5cbiAgcHJpdmF0ZSBvdmVycmlkZVNob3dUaW1lb3V0KCkge1xuICAgIGlmICh0aGlzLnNjaGVkdWxlZFNob3dUaW1lb3V0KSB7XG4gICAgICBjbGVhclRpbWVvdXQodGhpcy5zY2hlZHVsZWRTaG93VGltZW91dCk7XG4gICAgICB0aGlzLnNjaGVkdWxlZEhpZGVUaW1lb3V0ID0gMDtcbiAgICB9XG4gIH1cblxuICBwcml2YXRlIG92ZXJyaWRlSGlkZVRpbWVvdXQoKSB7XG4gICAgaWYgKHRoaXMuc2NoZWR1bGVkSGlkZVRpbWVvdXQpIHtcbiAgICAgIGNsZWFyVGltZW91dCh0aGlzLnNjaGVkdWxlZEhpZGVUaW1lb3V0KTtcbiAgICAgIHRoaXMuc2NoZWR1bGVkSGlkZVRpbWVvdXQgPSAwO1xuICAgIH1cbiAgfVxuXG4gIHByaXZhdGUgY29uc3RydWN0Q29udGVudCgpOiBQb3BwZXJDb250ZW50IHtcbiAgICBjb25zdCBmYWN0b3J5ID0gdGhpcy5yZXNvbHZlci5yZXNvbHZlQ29tcG9uZW50RmFjdG9yeSh0aGlzLnBvcHBlckNvbnRlbnRDbGFzcyk7XG4gICAgdGhpcy5wb3BwZXJDb250ZW50UmVmID0gdGhpcy52aWV3Q29udGFpbmVyUmVmLmNyZWF0ZUNvbXBvbmVudChmYWN0b3J5KTtcbiAgICByZXR1cm4gdGhpcy5wb3BwZXJDb250ZW50UmVmLmluc3RhbmNlIGFzIFBvcHBlckNvbnRlbnQ7XG4gIH1cblxuICBwcml2YXRlIHNldENvbnRlbnRQcm9wZXJ0aWVzKHBvcHBlclJlZjogUG9wcGVyQ29udGVudCkge1xuICAgIHBvcHBlclJlZi5wb3BwZXJPcHRpb25zID0gUG9wcGVyQ29udHJvbGxlci5hc3NpZ25EZWZpbmVkKHBvcHBlclJlZi5wb3BwZXJPcHRpb25zLCBQb3BwZXJDb250cm9sbGVyLmJhc2VPcHRpb25zLCB7XG4gICAgICBzaG93RGVsYXk6IHRoaXMuc2hvd0RlbGF5LFxuICAgICAgZGlzYWJsZUFuaW1hdGlvbjogdGhpcy5kaXNhYmxlQW5pbWF0aW9uLFxuICAgICAgZGlzYWJsZURlZmF1bHRTdHlsaW5nOiB0aGlzLmRpc2FibGVTdHlsZSxcbiAgICAgIHBsYWNlbWVudDogdGhpcy5wbGFjZW1lbnQsXG4gICAgICBib3VuZGFyaWVzRWxlbWVudDogdGhpcy5ib3VuZGFyaWVzRWxlbWVudCxcbiAgICAgIHRyaWdnZXI6IHRoaXMuc2hvd1RyaWdnZXIsXG4gICAgICBwb3NpdGlvbkZpeGVkOiB0aGlzLnBvc2l0aW9uRml4ZWQsXG4gICAgICBwb3BwZXJNb2RpZmllcnM6IHRoaXMucG9wcGVyTW9kaWZpZXJzLFxuICAgICAgYXJpYURlc2NyaWJlOiB0aGlzLmFyaWFEZXNjcmliZSxcbiAgICAgIGFyaWFSb2xlOiB0aGlzLmFyaWFSb2xlLFxuICAgICAgYXBwbHlDbGFzczogdGhpcy5hcHBseUNsYXNzLFxuICAgICAgYXBwbHlBcnJvd0NsYXNzOiB0aGlzLmFwcGx5QXJyb3dDbGFzcyxcbiAgICAgIGhpZGVPbk1vdXNlTGVhdmU6IHRoaXMuaGlkZU9uTW91c2VMZWF2ZSxcbiAgICAgIHN0eWxlczogdGhpcy5zdHlsZXMsXG4gICAgICBhcHBlbmRUbzogdGhpcy5hcHBlbmRUbyxcbiAgICAgIHByZXZlbnRPdmVyZmxvdzogdGhpcy5wcmV2ZW50T3ZlcmZsb3csXG4gICAgfSk7XG4gICAgcG9wcGVyUmVmLm9uVXBkYXRlID0gdGhpcy5vblBvcHBlclVwZGF0ZS5iaW5kKHRoaXMpO1xuICAgIHRoaXMuc3Vic2NyaXB0aW9ucy5wdXNoKHBvcHBlclJlZi5vbkhpZGRlbi5zdWJzY3JpYmUodGhpcy5oaWRlLmJpbmQodGhpcykpKTtcbiAgfVxuXG4gIHByaXZhdGUgZ2V0U2Nyb2xsUGFyZW50KG5vZGUpIHtcbiAgICBjb25zdCBpc0VsZW1lbnQgPSBub2RlIGluc3RhbmNlb2YgSFRNTEVsZW1lbnQ7XG4gICAgY29uc3Qgb3ZlcmZsb3dZID0gaXNFbGVtZW50ICYmIHdpbmRvdy5nZXRDb21wdXRlZFN0eWxlKG5vZGUpLm92ZXJmbG93WTtcbiAgICBjb25zdCBpc1Njcm9sbGFibGUgPSBvdmVyZmxvd1kgIT09ICd2aXNpYmxlJyAmJiBvdmVyZmxvd1kgIT09ICdoaWRkZW4nO1xuXG4gICAgaWYgKCFub2RlKSB7XG4gICAgICByZXR1cm4gbnVsbDtcbiAgICB9IGVsc2UgaWYgKGlzU2Nyb2xsYWJsZSAmJiBub2RlLnNjcm9sbEhlaWdodCA+PSBub2RlLmNsaWVudEhlaWdodCkge1xuICAgICAgcmV0dXJuIG5vZGU7XG4gICAgfVxuXG4gICAgcmV0dXJuIHRoaXMuZ2V0U2Nyb2xsUGFyZW50KG5vZGUucGFyZW50Tm9kZSkgfHwgZG9jdW1lbnQ7XG4gIH1cblxuICBwcml2YXRlIG9uUG9wcGVyVXBkYXRlKGV2ZW50KSB7XG4gICAgdGhpcy5wb3BwZXJPblVwZGF0ZS5lbWl0KGV2ZW50KTtcbiAgfVxuXG59XG4iXX0=